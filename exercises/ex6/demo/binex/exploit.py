from pwn import *
#import pwnlib
#.util.misc.run_in_new_terminal as run_in_new_terminal
import subprocess

qemu_cmd = "qemu-x86_64"
if args["GDB"]:
    qemu_cmd += " -g 1234 "

if args["C0"]:
    exe = "./c0"
elif args["C1"]:
    exe = "./c1"
elif args["C2"]:
    exe = "./c2"
elif args["C3"]:
    exe = "./c3"
else:
    print("please specifiy the target to run python3 exploit.py C1|C2|C3")
    exit(-1)

r = process(f"{qemu_cmd} {exe}", shell=True)


setup_gdb = """
gef-remote --qemu-user --qemu-binary /usr/bin/qemu-x86_64 127.0.0.1 1234
b main
c

"""

open("/tmp/setup_gdb.gdb","w+").write(setup_gdb)

if args["GDB"]:
    run_in_new_terminal(f'gdb-multiarch -q {exe} -x /tmp/setup_gdb.gdb')

if args["C0"]:
    """
    uncomment and write your exploit here:

    r.recvuntil(b"overflow me:")
    payload = b"asdf"
    r.sendline(payload)
    """

if args["C1"]:
    """
    uncomment and write your exploit here:
    """
    r.recvuntil(b"overflow me:")
    payload = b"asdf"
    r.sendline(payload)

if args["C2"]:
    """
    uncomment and write your exploit here:

    r.recvuntil(b"overflow me:")
    payload = b"asdf"
    r.sendline(payload)
    """

if args["C3"]:
    """
    uncomment and write your exploit here:

    r.recvuntil(b"overflow me:")
    payload = b"asdf"
    r.sendline(payload)
    """

# interact with the program
r.interactive()

