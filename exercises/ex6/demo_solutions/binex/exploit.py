from pwn import *

qemu_cmd = "qemu-x86_64"
if args["GDB"]:
    qemu_cmd += " -g 1234 "

if args["C0"]:
    exe = "./c0"
elif args["C1"]:
    exe = "./c1"
elif args["C2"]:
    exe = "./c2"
elif args["C3"]:
    exe = "./c3"
else:
    print("please specifiy the target to run python3 exploit.py C1|C2|C3")
    exit(-1)

r = process(f"{qemu_cmd} {exe}", shell=True)


if args["GDB"]:
    _, io_gdb = gdb.attach(("localhost", 1234),api=True, exe=exe)
    io_gdb.execute("b main")
    io_gdb.execute("c")

if args["C0"]:
    """
    uncomment and write your exploit here:

    r.recvuntil(b"overflow me:")
    payload = b"A" * 40
    r.sendline(payload)
    """

if args["C1"]:
    """
    uncomment and write your exploit here:

    r.recvuntil(b"overflow me:")
    payload = b"A" * 40
    r.sendline(payload)
    """

if args["C2"]:
    """
    uncomment and write your exploit here:

    r.recvuntil(b"overflow me:")
    payload = b"A" * 40
    r.sendline(payload)
    """

if args["C3"]:
    """
    uncomment and write your exploit here:

    r.recvuntil(b"overflow me:")
    payload = b"A" * 40
    r.sendline(payload)
    """

# interact with the program
r.interactive()

